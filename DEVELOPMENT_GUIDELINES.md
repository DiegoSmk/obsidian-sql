# Professional Development Guidelines - SQL Notebook

This document defines the architectural patterns, git workflow, and coding standards for this project. All contributions (human or AI) must strictly adhere to these guidelines.

## 0. Instructions for AI (Senior Persona)

Whenever working in this repository, **act as a Senior Software Engineer**. The code produced must be **production-grade**, strictly following:

1.  **Error Handling**: Implement try/catch blocks, clear and informative error messages. Never leave silent errors.
2.  **Security**: Ensure input sanitization (SQL Injection protection) and avoid exposing sensitive data. Use the existing `SQLSanitizer`.
3.  **Observability**: Include structured logs (using the project's `Logger.ts`) at critical points to facilitate debugging.
4.  **Scalability and Clean Code**: Utilize SOLID principles, strong typing (TypeScript), and ensure functions are small, modular, and testable.
5.  **Resilience**: For asynchronous or external operations, apply timeout strategies and ensure correct use of `AbortSignal` when available.
6.  **Documentation**: Add explanatory JSDoc comments to complex classes and methods.

---

## 1. Git Workflow (Professional Flow)

We follow a strict branching model:

- **`master`**: Only stable, production-ready code (Release launches).
- **`develop`**: Integration branch for new features.
- **`feature/xxx`**: Dedicated branch for new features, derived from `develop`.
- **`fix/xxx`**: Dedicated branch for bug fixes.

### Commit Standard (Conventional Commits)
Format: `<type>: <description>`
- `feat`: New feature.
- `fix`: Bug fix.
- `refactor`: Refactoring without behavioral change.
- `chore`: Maintenance (build, dependencies, CI/CD).
- `docs`: Documentation.

---

## 2. Architecture & Modularization

The project is modularized in `src/` to prevent monolithic growth:

- **`src/core`**: Business logic (QueryExecutor, DatabaseManager, CSVManager).
- **`src/ui`**: Rendering and interaction (ResultRenderer).
- **`src/utils`**: Cross-cutting utilities (Logger, Sanitizer).
- **`src/types`**: Global type definitions.

---

## 3. CSS Architecture (Modular Design)

To maintain design consistency and scalability, we do not use a single monolithic CSS file. Instead, we use a modular approach in `src/styles/`:

- **Design System**: All design tokens (colors, fonts, sizes) are centralized in `src/styles/theme/variables.css`.
- **Component-Level Styles**: Each major UI component has its own CSS file in `src/styles/components/`.
- **Bundling**: The final `styles.css` is generated by the build system from the entry point `src/styles/index.css`.

---

## 4. Engineering Rules (High Robustness)

1.  **SQL Parsing**: Never use naive `.split(';')`. Use AlaSQL's AST or conservative single-command checks.
2.  **LIMIT Injection**: Only inject `LIMIT 1000` into top-level `SELECT` statements that are clearly single queries and lack a manual LIMIT.
3.  **Safe Mode**: Use robust Regex for detecting blocked commands.

---

## 5. Development & Release Rituals
1.  **Build**: Always run `npm run build` after changes to validate the bundle.
2.  **Versioning**: Update the version in `package.json` and `manifest.json` before launching.
3.  **Automated Release**: Launch is triggered by **Git Tags** (`vX.X.X`). Gitea Actions handles packaging (`sql-notebook.zip`) and API-based Release publication.
4.  **Cleanup**: Binaries should not be submitted to Git. Use Gitea's Releases tab for downloading compiled versions.
